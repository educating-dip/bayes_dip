defaults:
  - base_sample_based_mll_optim_sto
num_samples: 2
num_samples_per_device: 2
iterations: 1
sampling:
  weights_linearisation: 
    optim_kwargs: #TODO: fine-tune
      iterations: 4000
      lr: 1e-3
      momentum: 0.9
      clip_grad_norm_value: 0.1
      scheduler_kwargs:
        start_factor: 1. 
        end_factor: 0.030
        total_iters_red_pct: 0.95
      use_warm_start: False
      polyak_averaging_factor: 1e-3
  hyperparams_update:
    optim_kwargs: #TODO: fine-tune
      iterations: 3000
      lr: 1e-4
      momentum: 0.9
      verbose: True
      clip_grad_norm_value: 1.
      scheduler_kwargs:
        start_factor: 1.
        end_factor: 0.030
        total_iters_red_pct: 0.95
      use_warm_start: False
      polyak_averaging_factor: 1e-3
use_sample_then_optimise: True
use_preconditioner: False

debugging_mode_kwargs:
  loglikelihood_kwargs:
    num_samples: 2
    patch_kwargs:
      batch_size: 2
      patch_idx_list: null